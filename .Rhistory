sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
amazon_salaries_race[i] = sal1
google_salaries_race[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their gender
gender = c("Male", "Female")
amazon_salaries_gender = rep(0, length(gender))
google_salaries_gender = rep(0, length(gender))
for(i in 1:length(gender)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
amazon_salaries_gender[i] = sal1
google_salaries_gender[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their education level
education_levels = c("Highschool", "Bachelor's Degree", "Master's Degree", "PhD", "Some College")
amazon_salaries_education = rep(0, length(education_levels))
google_salaries_education = rep(0, length(education_levels))
for(i in 1:length(education_levels)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
amazon_salaries_education[i] = sal1
google_salaries_education[i] = sal2
}
#Predict salaries across each quartile
employee_q1 = data.frame(company = "Amazon", level = "L3", title = "Human Resources", yearsofexperience = 5, gender = "Female", Race = "Asian", Education = "Master's Degree") #61000
employee_q2 = data.frame(company = "Google", level = "L8", title = "Technical Program Manager", yearsofexperience = 22, gender = "Female", Race = "White", Education = "Bachelor's Degree") #694000
employee_q3 = data.frame(company = "Amazon", level = "L7", title = "Software Engineering Manager", yearsofexperience = 18, gender = "Other", Race = "Two Or More", Education = "Master's Degree") #800000
employee_q4 = data.frame(company = "Google", level = "L8", title = "Software Engineer", yearsofexperience = 23, gender = "Male", Race = "White", Education = "Bachelor's Degree") #1160000
pred_salary_q1 = exp(predict(aic_model_final, newdata = employee_q1))
pred_salary_q2 = exp(predict(aic_model_final, newdata = employee_q2))
pred_salary_q3 = exp(predict(aic_model_final, newdata = employee_q3))
pred_salary_q4 = exp(predict(aic_model_final, newdata = employee_q4))
actual_salary_q1 = 61000
actual_salary_q2 = 694000
actual_salary_q3 = 800000
actual_salary_q4 = 1160000
pe_q1 = get_percent_error(pred_salary_q1, actual_salary_q1)
pe_q2 = get_percent_error(pred_salary_q2, actual_salary_q2)
pe_q3 = get_percent_error(pred_salary_q3, actual_salary_q3)
pe_q4 = get_percent_error(pred_salary_q4, actual_salary_q4)
row_names = c("Average RMSE Train", "Average RMSE Test", "Percent Error")
column_names = c("Statistic", "Value")
diagnostics = c(mean(rmse_trn), mean(rmse_tst), percent_error)
df_results = data.frame(row_names, diagnostics)
kable(df_results, "simple", col.names = column_names)
row_names = c("First", "Second", "Third", "Fourth")
column_names = c("Quartile", "Predicted", "Actual", "Percent Error")
pred_salaries = c(pred_salary_q1, pred_salary_q2, pred_salary_q3, pred_salary_q4)
actual_salaries = c(actual_salary_q1, actual_salary_q2, actual_salary_q3, actual_salary_q4)
pe_salaries = c(pe_q1 + "%", pe_q2, pe_q3, pe_q4)
row_names = c("First", "Second", "Third", "Fourth")
column_names = c("Quartile", "Predicted", "Actual", "Percent Error")
pred_salaries = c(pred_salary_q1, pred_salary_q2, pred_salary_q3, pred_salary_q4)
actual_salaries = c(actual_salary_q1, actual_salary_q2, actual_salary_q3, actual_salary_q4)
pe_salaries = c(pe_q1, pe_q2, pe_q3, pe_q4)
df_results = data.frame(row_names, pred_salaries, actual_salaries, pe_salaries)
kable(df_results, "simple", col.names = column_names)
row_names = c("First", "Second", "Third", "Fourth")
column_names = c("Quartile", "Predicted", "Actual", "Percent Error")
pred_salaries = c(pred_salary_q1, pred_salary_q2, pred_salary_q3, pred_salary_q4)
actual_salaries = c(actual_salary_q1, actual_salary_q2, actual_salary_q3, actual_salary_q4)
pe_salaries = c(round(pe_q1, 2), pe_q2, pe_q3, pe_q4)
df_results = data.frame(row_names, pred_salaries, actual_salaries, pe_salaries)
kable(df_results, "simple", col.names = column_names)
row_names = c("First", "Second", "Third", "Fourth")
column_names = c("Quartile", "Predicted", "Actual", "Percent Error")
pred_salaries = c(pred_salary_q1, pred_salary_q2, pred_salary_q3, pred_salary_q4)
actual_salaries = c(actual_salary_q1, actual_salary_q2, actual_salary_q3, actual_salary_q4)
pe_salaries = c(round(pe_q1, 2), round(pe_q2, 2), round(pe_q3, 2), round(pe_q4, 2))
df_results = data.frame(row_names, pred_salaries, actual_salaries, pe_salaries)
kable(df_results, "simple", col.names = column_names)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
options(digits = 4)
#Loading dataset and importing libraries
library(readr)
library(stringr)
salaries = read_csv("Levels-Fyi-Salary-Data-Cleaned-US.csv")
#Remove NA records
salaries = na.omit(salaries)
#Changing some predictors to factors
salaries$company = as.factor(salaries$company)
salaries$level = as.factor(salaries$level)
salaries$title = as.factor(salaries$title)
salaries$location = as.factor(salaries$location)
salaries$gender = as.factor(salaries$gender)
salaries$Race = as.factor(salaries$Race)
salaries$Education = as.factor(salaries$Education)
#Variable Selection: Removed variables that contain redundant information or lack of information
salaries = subset(salaries, select = c(company, level, title,
totalyearlycompensation, location,
yearsofexperience, yearsatcompany, tag,
gender, Race, Education))
#Importing library
library(caret)
#Split the data 70-30 into train and test sets
set.seed(22)
trn_idx = createDataPartition(salaries$level, p = 0.7, list = F)
trn = salaries[trn_idx, ]
tst = salaries[-trn_idx, ]
#Model w/ 'totalyearlycompensation' as the response variable and all remaining variables as the predictors
salaries_model = lm(totalyearlycompensation ~ ., data = trn)
#Backward AIC
salaries_model_back_aic = step(salaries_model,
direction = "backward", trace = 0)
#Backward BIC
salaries_model_back_bic = step(salaries_model, direction = "backward",
k = log(nrow(trn)), trace = 0)
#Performing anova test on the AIC and BIC models
anova(salaries_model_back_bic, salaries_model_back_aic)
#Checking the collinearity of the AIC model
car::vif(salaries_model_back_aic)
#Performing log response transformation to improve linearity
aic_model_log = lm(log(totalyearlycompensation) ~ company + yearsofexperience + title + level + gender + Race + Education, data = trn)
#Adding interactions to improve normality, linearity and constant variance
aic_model_trans = lm(log(totalyearlycompensation) ~ (company + yearsofexperience + title) ^ 2 + level + gender + Race + Education, data = trn)
#Performing anova test between the two models
anova(aic_model_log, aic_model_trans)
#Removing influential data points from the model
aic_model_final = lm(log(totalyearlycompensation) ~ (company + yearsofexperience + title) ^ 2 + level + gender + Race + Education, data = trn, subset = cooks.distance(aic_model_trans) < 4 / length(cooks.distance(aic_model_trans)))
#Importing libraries
library(car)
library(lmtest)
library(boot)
library(knitr)
#LOOCV RMSE Function - Gets the difference between the predicted values a model generates and the actual values
get_loocv_rmse = function(model){
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
#Diagnostics
adj_initial = summary(salaries_model)$adj
adj_aic = summary(salaries_model_back_aic)$adj
adj_log = summary(aic_model_log)$adj
adj_final = summary(aic_model_final)$adj
loocv_rmse_final = get_loocv_rmse(aic_model_final)
shapiro_final = shapiro.test(resid(aic_model_final))$p.value
bp_final = test = bptest(aic_model_final)$p.value
loocv_rmse_final
#Get Percent Error Function - Calculates the percentage of error we expect our model to generate
get_percent_error = function(pred_salary, actual_salary){
mean((abs(pred_salary - actual_salary) / pred_salary)) * 100
}
#Calculating average percent error of the test set
actual_salary = tst$totalyearlycompensation
pred_salary = exp(predict(aic_model_final, tst))
max_pe_salary = ifelse(max(actual_salary) > max(pred_salary), max(actual_salary), max(pred_salary))
percent_error = get_percent_error(pred_salary, actual_salary)
#Simulation Set-Up
num_sims = 1000
rmse_trn = rep(0, num_sims)
rmse_tst = rep(0, num_sims)
#RMSE Function - Finds the difference between the predicted values and the actual values
rmse = function(y, y_hat){
sqrt(sum((y - y_hat) ^ 2) / length(y))
}
#Storing Train RMSE and Test RMSE
for(i in 1:num_sims){
sim_fit = lm(log(totalyearlycompensation) ~ (company + yearsofexperience + title) ^ 2 + level + gender + Race + Education, data = trn)
rmse_trn[i] = rmse(trn$totalyearlycompensation, exp(predict(sim_fit, trn)))
rmse_tst[i] = rmse(tst$totalyearlycompensation, exp(predict(sim_fit, tst)))
}
#Initializing variables for predicting a persons salary based upon their race
race = c("White", "Black", "Hispanic", "Asian", "Two Or More")
amazon_salaries_race = rep(0, length(unique(salaries$Race)))
google_salaries_race = rep(0, length(unique(salaries$Race)))
for(i in 1:length(unique(salaries$Race))) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
amazon_salaries_race[i] = sal1
google_salaries_race[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their gender
gender = c("Male", "Female")
amazon_salaries_gender = rep(0, length(gender))
google_salaries_gender = rep(0, length(gender))
for(i in 1:length(gender)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
amazon_salaries_gender[i] = sal1
google_salaries_gender[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their education level
education_levels = c("Highschool", "Bachelor's Degree", "Master's Degree", "PhD", "Some College")
amazon_salaries_education = rep(0, length(education_levels))
google_salaries_education = rep(0, length(education_levels))
for(i in 1:length(education_levels)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
amazon_salaries_education[i] = sal1
google_salaries_education[i] = sal2
}
#Predict salaries across each quartile
employee_q1 = data.frame(company = "Amazon", level = "L3", title = "Human Resources", yearsofexperience = 5, gender = "Female", Race = "Asian", Education = "Master's Degree") #61000
employee_q2 = data.frame(company = "Google", level = "L8", title = "Technical Program Manager", yearsofexperience = 22, gender = "Female", Race = "White", Education = "Bachelor's Degree") #694000
employee_q3 = data.frame(company = "Amazon", level = "L7", title = "Software Engineering Manager", yearsofexperience = 18, gender = "Other", Race = "Two Or More", Education = "Master's Degree") #800000
employee_q4 = data.frame(company = "Google", level = "L8", title = "Software Engineer", yearsofexperience = 23, gender = "Male", Race = "White", Education = "Bachelor's Degree") #1160000
pred_salary_q1 = exp(predict(aic_model_final, newdata = employee_q1))
pred_salary_q2 = exp(predict(aic_model_final, newdata = employee_q2))
pred_salary_q3 = exp(predict(aic_model_final, newdata = employee_q3))
pred_salary_q4 = exp(predict(aic_model_final, newdata = employee_q4))
actual_salary_q1 = 61000
actual_salary_q2 = 694000
actual_salary_q3 = 800000
actual_salary_q4 = 1160000
pe_q1 = get_percent_error(pred_salary_q1, actual_salary_q1)
pe_q2 = get_percent_error(pred_salary_q2, actual_salary_q2)
pe_q3 = get_percent_error(pred_salary_q3, actual_salary_q3)
pe_q4 = get_percent_error(pred_salary_q4, actual_salary_q4)
row_names = c("Average RMSE Train", "Average RMSE Test", "Percent Error")
column_names = c("Statistic", "Value")
diagnostics = c(mean(rmse_trn), mean(rmse_tst), percent_error)
df_results = data.frame(row_names, diagnostics)
kable(df_results, "simple", col.names = column_names)
row_names = c("Initial Model", "AIC Model","Log Response Model", "Final Model")
column_names = c("Model", "Adjusted R")
adj_r = c(adj_initial, adj_aic, adj_log, adj_final)
df_results = data.frame(row_names, adj_r)
kable(df_results, "simple", col.names = column_names)
par(mfrow = c(1,3))
# Q-Q plot of initial model without log response transformation
qqnorm(resid(salaries_model_back_aic), main = "Normal Q-Q Plot Before Log Response", col = "darkgrey")
qqline(resid(salaries_model_back_aic), col = "dodgerblue", lwd = 2)
# Q-Q plot after log response transformation
qqnorm(resid(aic_model_log), main = "Normal Q-Q Plot After Log Response", col = "darkgrey")
qqline(resid(aic_model_log), col = "dodgerblue", lwd = 2)
# Q-Q plot after all transformations
qqnorm(resid(aic_model_final), main = "Normal Q-Q Plot After All Transformations", col = "darkgrey")
qqline(resid(aic_model_final), col = "dodgerblue", lwd = 2)
par(mfrow = c(1,3))
#Residuals vs Fitted plot of initial model without log response transformation
plot(fitted(salaries_model_back_aic), resid(salaries_model_back_aic), col = "grey", pch = 20,
xlab = "Fitted", ylab = "Residuals", main = "Fitted vs Resids Before Log Response")
abline(h = 0, col = "darkorange", lwd = 2)
#Residuals vs Fitted plot after log response transformation
plot(fitted(aic_model_log), resid(aic_model_log), col = "grey", pch = 20,
xlab = "Fitted", ylab = "Residuals", main = "Fitted vs Resids After Log Response")
abline(h = 0, col = "darkorange", lwd = 2)
#Residuals vs Fitted plot after all transformations
plot(fitted(aic_model_final), resid(aic_model_final), col = "grey", pch = 20,
xlab = "Fitted", ylab = "Residuals", main = "Fitted vs Resids After All Transformations")
abline(h = 0, col = "darkorange", lwd = 2)
plot(pred_salary, actual_salary,
col = "darkgrey",
xlab = "Predicted Salaries Prices",
ylab = "Actual Salaries",
main = "Predicted vs. Actual Salaries",
xlim = c(0, max_pe_salary),
ylim = c(0, max_pe_salary)
)
abline(0, 1, col = "dodgerblue")
row_names = c("First", "Second", "Third", "Fourth")
column_names = c("Quartile", "Predicted", "Actual", "Percent Error")
pred_salaries = c(pred_salary_q1, pred_salary_q2, pred_salary_q3, pred_salary_q4)
actual_salaries = c(actual_salary_q1, actual_salary_q2, actual_salary_q3, actual_salary_q4)
pe_salaries = c(round(pe_q1, 2), round(pe_q2, 2), round(pe_q3, 2), round(pe_q4, 2))
df_results = data.frame(row_names, pred_salaries, actual_salaries, pe_salaries)
kable(df_results, "simple", col.names = column_names)
# Define common y-axis limits
max_salary = max(c(amazon_salaries_race, google_salaries_race))*1.1
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_race, names.arg = race, col=rainbow(length(amazon_salaries_race)),
main = "AMZN: L1 Salary Based on Race", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_race, names.arg = race, col=rainbow(length(google_salaries_race)),
main = "GOOG: L1 Salary Based on Race", ylab = "Total Compensation", ylim = c(0, max_salary))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_gender, names.arg = gender, col=c("blue", "red"),
main = "AMZN: L1 Salary Based on Gender", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_gender, names.arg = gender, col=c("blue", "red"),
main = "GOOG: L1 Salary Based on Gender", ylab = "Total Compensation", ylim = c(0, max_salary))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
ax.set_xticklabels(labels))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
las = 2,
cex.names = 1)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = 1)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = 2)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = .5)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary))
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = .65)
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = .58))
# Plot
par(mfrow = c(1,2))
barplot(amazon_salaries_education, names.arg = education_levels, col=rainbow(length(amazon_salaries_education)),
main = "AMZN: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = .58)
barplot(google_salaries_education, names.arg = education_levels, col=rainbow(length(google_salaries_education)),
main = "GOOG: L1 Salary Based on Education Level", ylab = "Total Compensation", ylim = c(0, max_salary),
cex.names = .58)
row_names = c("Initial Model", "AIC Model","Log Response Model", "Final Model")
column_names = c("Model", "Adjusted R")
adj_r = c(adj_initial, adj_aic, adj_log, adj_final)
df_results = data.frame(row_names, adj_r)
kable(df_results, "simple", col.names = column_names)
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = White, Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = white, Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree")))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
round(1486.0516189, -2)
#Will be used later for the discussion on why google entry level is so high
exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Will be used later for the discussion on why google entry level is so high
res = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Initializing variables for predicting a persons salary based upon their race
race = c("White", "Black", "Hispanic", "Asian", "Two Or More")
amazon_salaries_race = rep(0, length(unique(salaries$Race)))
google_salaries_race = rep(0, length(unique(salaries$Race)))
for(i in 1:length(unique(salaries$Race))) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
amazon_salaries_race[i] = sal1
google_salaries_race[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their gender
gender = c("Male", "Female")
amazon_salaries_gender = rep(0, length(gender))
google_salaries_gender = rep(0, length(gender))
for(i in 1:length(gender)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
amazon_salaries_gender[i] = sal1
google_salaries_gender[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their education level
education_levels = c("Highschool", "Bachelor's Degree", "Master's Degree", "PhD", "Some College")
amazon_salaries_education = rep(0, length(education_levels))
google_salaries_education = rep(0, length(education_levels))
for(i in 1:length(education_levels)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
amazon_salaries_education[i] = sal1
google_salaries_education[i] = sal2
}
#Predict salaries across each quartile
employee_q1 = data.frame(company = "Amazon", level = "L3", title = "Human Resources", yearsofexperience = 5, gender = "Female", Race = "Asian", Education = "Master's Degree") #61000
employee_q2 = data.frame(company = "Google", level = "L8", title = "Technical Program Manager", yearsofexperience = 22, gender = "Female", Race = "White", Education = "Bachelor's Degree") #694000
employee_q3 = data.frame(company = "Amazon", level = "L7", title = "Software Engineering Manager", yearsofexperience = 18, gender = "Other", Race = "Two Or More", Education = "Master's Degree") #800000
employee_q4 = data.frame(company = "Google", level = "L8", title = "Software Engineer", yearsofexperience = 23, gender = "Male", Race = "White", Education = "Bachelor's Degree") #1160000
pred_salary_q1 = exp(predict(aic_model_final, newdata = employee_q1))
pred_salary_q2 = exp(predict(aic_model_final, newdata = employee_q2))
pred_salary_q3 = exp(predict(aic_model_final, newdata = employee_q3))
pred_salary_q4 = exp(predict(aic_model_final, newdata = employee_q4))
actual_salary_q1 = 61000
actual_salary_q2 = 694000
actual_salary_q3 = 800000
actual_salary_q4 = 1160000
pe_q1 = get_percent_error(pred_salary_q1, actual_salary_q1)
pe_q2 = get_percent_error(pred_salary_q2, actual_salary_q2)
pe_q3 = get_percent_error(pred_salary_q3, actual_salary_q3)
pe_q4 = get_percent_error(pred_salary_q4, actual_salary_q4)
##Predicted L1 salaries based on company
amazon_l1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
google_l1 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
#Initializing variables for predicting a persons salary based upon their race
race = c("White", "Black", "Hispanic", "Asian", "Two Or More")
amazon_salaries_race = rep(0, length(unique(salaries$Race)))
google_salaries_race = rep(0, length(unique(salaries$Race)))
for(i in 1:length(unique(salaries$Race))) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = race[i], Education = "Bachelor's Degree")))
amazon_salaries_race[i] = sal1
google_salaries_race[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their gender
gender = c("Male", "Female")
amazon_salaries_gender = rep(0, length(gender))
google_salaries_gender = rep(0, length(gender))
for(i in 1:length(gender)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = gender[i], Race = "White", Education = "Bachelor's Degree")))
amazon_salaries_gender[i] = sal1
google_salaries_gender[i] = sal2
}
# Initializing variables for predicting a person's salary based upon their education level
education_levels = c("Highschool", "Bachelor's Degree", "Master's Degree", "PhD", "Some College")
amazon_salaries_education = rep(0, length(education_levels))
google_salaries_education = rep(0, length(education_levels))
for(i in 1:length(education_levels)) {
sal1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
sal2 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L1", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = education_levels[i])))
amazon_salaries_education[i] = sal1
google_salaries_education[i] = sal2
}
#Predict salaries across each quartile
employee_q1 = data.frame(company = "Amazon", level = "L3", title = "Human Resources", yearsofexperience = 5, gender = "Female", Race = "Asian", Education = "Master's Degree") #61000
employee_q2 = data.frame(company = "Google", level = "L8", title = "Technical Program Manager", yearsofexperience = 22, gender = "Female", Race = "White", Education = "Bachelor's Degree") #694000
employee_q3 = data.frame(company = "Amazon", level = "L7", title = "Software Engineering Manager", yearsofexperience = 18, gender = "Other", Race = "Two Or More", Education = "Master's Degree") #800000
employee_q4 = data.frame(company = "Google", level = "L8", title = "Software Engineer", yearsofexperience = 23, gender = "Male", Race = "White", Education = "Bachelor's Degree") #1160000
pred_salary_q1 = exp(predict(aic_model_final, newdata = employee_q1))
pred_salary_q2 = exp(predict(aic_model_final, newdata = employee_q2))
pred_salary_q3 = exp(predict(aic_model_final, newdata = employee_q3))
pred_salary_q4 = exp(predict(aic_model_final, newdata = employee_q4))
actual_salary_q1 = 61000
actual_salary_q2 = 694000
actual_salary_q3 = 800000
actual_salary_q4 = 1160000
pe_q1 = get_percent_error(pred_salary_q1, actual_salary_q1)
pe_q2 = get_percent_error(pred_salary_q2, actual_salary_q2)
pe_q3 = get_percent_error(pred_salary_q3, actual_salary_q3)
pe_q4 = get_percent_error(pred_salary_q4, actual_salary_q4)
##Predicted L1 salaries based on company
amazon_l1 = exp(predict(aic_model_final, data.frame(company = "Amazon", level = "L3", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
google_l1 = exp(predict(aic_model_final, data.frame(company = "Google", level = "L3", title = "Software Engineer", yearsofexperience = 0, gender = "Male", Race = "White", Education = "Bachelor's Degree"), interval = "prediction"))[1]
amazon_l1
google_l1
amazon_salaries_gender
amazon_salaries_gender[1] + google_salaries_gender[1]
amazon_salaries_gender[2] + google_salaries_gender[2]
male_entry_salary = amazon_salaries_gender[1] + google_salaries_gender[1]
female_entry_salary = amazon_salaries_gender[2] + google_salaries_gender[2]
male_entry_salary / female_entry_salary
male_entry_salary = amazon_salaries_gender[1] + google_salaries_gender[1]
female_entry_salary = amazon_salaries_gender[2] + google_salaries_gender[2]
1 - male_entry_salary / female_entry_salary
male_entry_salary = amazon_salaries_gender[1] + google_salaries_gender[1]
female_entry_salary = amazon_salaries_gender[2] + google_salaries_gender[2]
male_entry_salary / female_entry_salary - 1
male_entry_salary = amazon_salaries_gender[1] + google_salaries_gender[1]
female_entry_salary = amazon_salaries_gender[2] + google_salaries_gender[2]
round(male_entry_salary / female_entry_salary - 1, 2)
